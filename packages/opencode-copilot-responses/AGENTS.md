# Copilot Proxy ID Rotation

The GitHub Copilot proxy re-encrypts all item IDs (`item_id`, `item.id`) on every SSE event within a single streaming response, producing different opaque 416-char base64 blobs for what is logically the same output item. It also re-encrypts per-request, so IDs from response N are unresolvable in request N+1. This breaks any code that tracks or correlates items by ID â€” including the stock `@ai-sdk/openai` SDK, which keys its internal `activeReasoning` map on `item_id`. Two mitigations exist in `provider/fetch.ts` and `provider/normalize.ts`: (1) the response stream is piped through `normalizeReasoningIds`, which records the canonical `item.id` from each `response.output_item.added` event and rewrites all subsequent events for that `output_index` to use it, and (2) outbound requests have `id` fields stripped from input items (except `item_reference`) since stale IDs are meaningless to the proxy. Any new SSE event types that carry `item_id` or `item.id` must be added to the `ITEM_ID_EVENTS` set in `normalize.ts`, and any code that relies on ID stability across requests must account for the fact that IDs are ephemeral.
